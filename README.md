![image](https://github.com/user-attachments/assets/5e1a55be-3e5e-4196-ba39-5eb488c09afb)


# üï∑Ô∏è WebPhantom CLI

<p align="center">
  <img src="https://img.shields.io/badge/Kali-Linux-557C94?style=for-the-badge&logo=kali-linux&logoColor=white" alt="Kali Linux"/>
  <img src="https://img.shields.io/badge/Python-3.8+-blue.svg?style=for-the-badge&logo=python&logoColor=white" alt="Python 3.8+"/>
  <img src="https://img.shields.io/badge/License-MIT-green.svg?style=for-the-badge" alt="License: MIT"/>
</p>

<p align="center">
  <b>Outil de pentest web automatis√© pour Kali Linux</b><br>
  <sub>üîç Reconnaissance | üî¨ Scan de vuln√©rabilit√©s | ü§ñ Analyse IA | üß™ Tests automatis√©s | üìä Rapports d√©taill√©s</sub>
</p>

---

## üìã Description

**WebPhantom** est un outil en ligne de commande con√ßu pour **automatiser les tests de p√©n√©tration web** sur Kali Linux. Il permet de r√©aliser rapidement des reconnaissances, des scans de vuln√©rabilit√©s avanc√©s, des analyses bas√©es sur l'IA (LLaMA), et g√©n√®re des rapports d√©taill√©s.

> ‚ö†Ô∏è **Avertissement** : Cet outil est destin√© exclusivement √† des fins l√©gitimes telles que les tests de p√©n√©tration, la formation √† la sensibilisation √† la s√©curit√© et l'√©valuation des vuln√©rabilit√©s. Toute utilisation non autoris√©e est ill√©gale et contraire √† l'√©thique.

### üîç Fonctionnalit√©s principales

- üîé **Reconnaissance automatis√©e** des applications web
- üõ°Ô∏è **D√©tection avanc√©e de vuln√©rabilit√©s** (XSS, SQLi, LFI, CSRF, SSRF, XXE, etc.)
- üß† **Analyse IA avec LLaMA** pour l'identification intelligente des vuln√©rabilit√©s
- üìä **G√©n√©ration de rapports d√©taill√©s** en HTML/PDF avec haute lisibilit√©
- üîê **Gestion compl√®te des utilisateurs et authentification** (Basic, Forms, JWT)
- üí£ **Cr√©ation de charges utiles personnalis√©es** pour diff√©rents types d'attaques
- üìú **Sc√©narios YAML** pour orchestrer des tests complets
- üîç **Fuzzing d'API et de param√®tres** pour d√©couvrir des vuln√©rabilit√©s cach√©es
- üîí **Analyse SSL/TLS** pour v√©rifier la s√©curit√© des connexions
- üî® **Tests de r√©sistance DoS** pour √©valuer la robustesse des applications
- üöÄ **Extensible** par l'ajout de nouveaux modules et payloads
- üîÑ **Rapide et l√©ger**, parfait pour les pentests rapides

## ‚öôÔ∏è Installation

### Installation avec environnement virtuel (recommand√© pour Kali Linux)

En raison de la politique de gestion des paquets Python sur Kali Linux (PEP 668), il est recommand√© d'utiliser un environnement virtuel :

```bash
# Cloner le d√©p√¥t
git clone https://github.com/servais1983/WebPhantom.git
cd WebPhantom

# Installer python3-venv si ce n'est pas d√©j√† fait
sudo apt install python3-venv

# Cr√©er un environnement virtuel
python3 -m venv webphantom_env

# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Installer d'abord les d√©pendances de base
pip install requests beautifulsoup4 nltk

# Puis installer toutes les d√©pendances
pip install -r requirements.txt
```

### Installation manuelle (alternative, non recommand√©e sur Kali)

```bash
# Cloner le d√©p√¥t
git clone https://github.com/servais1983/WebPhantom.git
cd WebPhantom

# Rendre le script d'installation ex√©cutable
chmod +x install.sh

# Lancer l'installation
./install.sh

# Installation manuelle des d√©pendances (sur Kali, utilisez --break-system-packages avec pr√©caution)
pip install -r requirements.txt --break-system-packages
```

### üì¶ D√©pendances principales

- Python 3.8+
- llama-cpp-python (pour l'analyse IA)
- nltk (pour le traitement du langage naturel)
- weasyprint (pour la g√©n√©ration de PDF)
- pyjwt et bcrypt (pour l'authentification)
- requests et beautifulsoup4 (pour la reconnaissance web)
- pycryptodome (pour le chiffrement des charges utiles)

## üõ†Ô∏è Commandes

| Commande | Description | Exemple avec environnement virtuel |
|----------|-------------|-----------------------------------|
| `recon` | Analyse de surface (HTML, forms, scripts, headers) | `source webphantom_env/bin/activate && python webphantom.py recon http://testphp.vulnweb.com` |
| `scan` | Test de vuln√©rabilit√©s simples (XSS, SQLi, LFI) | `source webphantom_env/bin/activate && python webphantom.py scan http://testphp.vulnweb.com` |
| `advanced-scan` | Scan avanc√© (CSRF, SSRF, XXE, etc.) | `source webphantom_env/bin/activate && python webphantom.py advanced-scan http://testphp.vulnweb.com` |
| `ai` | Analyse IA avec LLaMA | `source webphantom_env/bin/activate && python webphantom.py ai http://testphp.vulnweb.com` |
| `report` | G√©n√©ration de rapport HTML/PDF | `source webphantom_env/bin/activate && python webphantom.py report results.json --format pdf --output rapport.pdf` |
| `payload` | G√©n√©ration de charges utiles personnalis√©es | `source webphantom_env/bin/activate && python webphantom.py payload xss --transform url` |
| `auth` | Gestion des utilisateurs et authentification | `source webphantom_env/bin/activate && python webphantom.py auth register --username pentester --email pentester@example.com --role admin` |
| `run` | Sc√©nario YAML (pentest-as-code) | `source webphantom_env/bin/activate && python webphantom.py run scripts/advanced_web_test.yaml --target http://testphp.vulnweb.com` |

## üöÄ Exemple d'utilisation

### Reconnaissance d'un site web

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Lancer la reconnaissance sur une cible sp√©cifique
python webphantom.py recon http://testphp.vulnweb.com
```

Cette commande analysera le site web et affichera des informations sur :
- Le code HTTP de la r√©ponse
- Le type de serveur web
- Les formulaires d√©tect√©s
- Les balises scripts trouv√©es

### Scan avanc√© de vuln√©rabilit√©s

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Lancer le scan avanc√© sur une cible sp√©cifique
python webphantom.py advanced-scan http://testphp.vulnweb.com
```

Cette commande effectuera un scan approfondi pour d√©tecter :
- Vuln√©rabilit√©s CSRF
- Vuln√©rabilit√©s SSRF
- Injections XXE
- Vuln√©rabilit√©s IDOR
- Et bien d'autres...

### Analyse avec IA (LLaMA)

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Lancer l'analyse IA sur une cible sp√©cifique
python webphantom.py ai http://testphp.vulnweb.com
```

Cette commande utilise le mod√®le LLaMA pour :
- Analyser le comportement de l'application
- Identifier des patterns de vuln√©rabilit√©s complexes
- Sugg√©rer des vecteurs d'attaque potentiels
- Fournir une analyse contextuelle

### G√©n√©ration de rapport

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# G√©n√©rer un rapport PDF √† partir des r√©sultats de scan
python webphantom.py report scan_results.json --format pdf --output rapport_pentest.pdf
```

Cette commande g√©n√®re un rapport d√©taill√© avec :
- R√©sum√© des vuln√©rabilit√©s trouv√©es
- D√©tails techniques pour chaque vuln√©rabilit√©
- Captures d'√©cran et preuves
- Recommandations de correction

### Cr√©ation de charges utiles personnalis√©es

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Cr√©er un ensemble de charges utiles XSS personnalis√©es
python webphantom.py payload xss --create --name "XSS avanc√©" --output custom_xss.json
```

Cette commande permet de cr√©er et g√©rer des charges utiles pour :
- XSS (Cross-Site Scripting)
- SQLi (Injection SQL)
- XXE (XML External Entity)
- CSRF (Cross-Site Request Forgery)
- Et d'autres types d'attaques

### Gestion des utilisateurs

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Cr√©er un nouvel utilisateur avec le r√¥le admin
python webphantom.py auth register --username pentester --email pentester@example.com --role admin
```

Cette commande permet de g√©rer les utilisateurs avec :
- Cr√©ation et gestion de comptes
- Attribution de r√¥les et permissions
- Authentification s√©curis√©e
- Gestion des tokens JWT

### Ex√©cution d'un sc√©nario complet

```bash
# Activer l'environnement virtuel
source webphantom_env/bin/activate

# Ex√©cuter le sc√©nario avanc√© sur une cible sp√©cifique
# Note: Vous pouvez sp√©cifier la cible de trois fa√ßons diff√©rentes
python webphantom.py run scripts/advanced_web_test.yaml --target http://testphp.vulnweb.com
# OU
python webphantom.py run scripts/advanced_web_test.yaml http://testphp.vulnweb.com
# OU d√©finir la cible dans le fichier YAML lui-m√™me
```

Cette commande ex√©cutera un sc√©nario complet qui :
1. Effectue une reconnaissance du site cible
2. Teste les vuln√©rabilit√©s avanc√©es
3. R√©alise une analyse avec LLaMA
4. G√©n√®re un rapport d√©taill√©

## üìú Sc√©narios YAML avanc√©s

WebPhantom prend en charge des sc√©narios YAML avanc√©s pour automatiser des tests de p√©n√©tration complets. Voici un exemple de sc√©nario avanc√© :

```yaml
target: https://example.com
steps:
  - type: recon
  - type: fingerprint
    options:
      detailed: true
  - type: scan
  - type: wait
    options:
      seconds: 2
  - type: advanced-scan
    options:
      scan_csrf: true
      scan_ssrf: true
      scan_xxe: true
  - type: fuzz
    options:
      type: api
      wordlist: common
  - type: ssl-scan
  - type: brute-force
    options:
      target: login
      wordlist: common
  - type: ai
    options:
      model: llama-7b-q4
  - type: report
    options:
      format: pdf
```

### Types d'√©tapes support√©es

| Type d'√©tape | Description | Options |
|--------------|-------------|---------|
| `recon` | Reconnaissance de base | - |
| `scan` | Scan de vuln√©rabilit√©s basiques | - |
| `advanced-scan` | Scan de vuln√©rabilit√©s avanc√©es | `scan_csrf`, `scan_ssrf`, `scan_xxe`, `scan_idor` |
| `ai` / `ai_analysis` | Analyse IA avec LLaMA | `model` |
| `auth` | Gestion de l'authentification | `type`, `username`, `password`, `email`, `role` |
| `payload` | G√©n√©ration de charges utiles | `type`, `transform`, `output` |
| `report` | G√©n√©ration de rapports | `format`, `output` |
| `fuzz` | Fuzzing d'API et de param√®tres | `type` (`parameter` ou `api`), `wordlist` |
| `fingerprint` | Fingerprinting avanc√© | `detailed` |
| `brute-force` | Attaque par force brute | `target`, `wordlist` |
| `ssl-scan` | Analyse SSL/TLS | - |
| `dos-test` | Test de r√©sistance aux attaques DoS | - |
| `wait` | Attente entre les √©tapes | `seconds` |

### Sauvegarde des r√©sultats

Les r√©sultats de chaque sc√©nario sont automatiquement sauvegard√©s dans un dossier horodat√© (`results_YYYYMMDD_HHMMSS/`) contenant :
- Un fichier JSON avec tous les r√©sultats (`results.json`)
- Les rapports g√©n√©r√©s au format sp√©cifi√©
- Les charges utiles personnalis√©es cr√©√©es

## üóÇÔ∏è Structure du projet

```
webphantom/
‚îú‚îÄ‚îÄ core/                    # Modules principaux
‚îÇ   ‚îú‚îÄ‚îÄ recon.py             # Module de reconnaissance
‚îÇ   ‚îú‚îÄ‚îÄ vulns.py             # Scanner de vuln√©rabilit√©s basiques
‚îÇ   ‚îú‚îÄ‚îÄ advanced_vulns.py    # Scanner de vuln√©rabilit√©s avanc√©es
‚îÇ   ‚îú‚îÄ‚îÄ llm_integration.py   # Int√©gration du mod√®le LLaMA
‚îÇ   ‚îú‚îÄ‚îÄ report_generator.py  # G√©n√©rateur de rapports HTML/PDF
‚îÇ   ‚îú‚îÄ‚îÄ auth.py              # Gestion des utilisateurs et authentification
‚îÇ   ‚îú‚îÄ‚îÄ payload_generator.py # G√©n√©rateur de charges utiles personnalis√©es
‚îÇ   ‚îî‚îÄ‚îÄ utils.py             # Fonctions utilitaires et moteur de sc√©nario
‚îú‚îÄ‚îÄ scripts/                 # Sc√©narios pr√©d√©finis
‚îÇ   ‚îú‚îÄ‚îÄ basic_web_test.yaml
‚îÇ   ‚îî‚îÄ‚îÄ advanced_web_test.yaml
‚îú‚îÄ‚îÄ templates/               # Templates pour les rapports
‚îÇ   ‚îî‚îÄ‚îÄ report_template.html
‚îú‚îÄ‚îÄ tests.py                 # Tests unitaires
‚îú‚îÄ‚îÄ webphantom.py            # Point d'entr√©e principal
‚îú‚îÄ‚îÄ requirements.txt         # D√©pendances Python
‚îú‚îÄ‚îÄ requirements_minimal.txt # D√©pendances minimales
‚îú‚îÄ‚îÄ TROUBLESHOOTING.md       # Guide de d√©pannage
‚îú‚îÄ‚îÄ install.sh               # Script d'installation
‚îî‚îÄ‚îÄ README.md                # Documentation
```

## üìä Modules principaux

### üß† Module d'int√©gration LLaMA

Le module `llm_integration.py` permet d'utiliser le mod√®le LLaMA pour analyser les applications web et identifier des vuln√©rabilit√©s complexes :

- T√©l√©chargement et v√©rification automatique des mod√®les
- Pr√©traitement du texte avec NLTK pour une analyse optimis√©e
- Analyse contextuelle du code source et des r√©ponses HTTP
- Identification de patterns de vuln√©rabilit√©s non d√©tectables par des scanners traditionnels
- Suggestions d'exploitation et recommandations de correction

### üîç Scanner de vuln√©rabilit√©s avanc√©es

Le module `advanced_vulns.py` √©tend les capacit√©s de scan avec :

- D√©tection de CSRF (Cross-Site Request Forgery)
- D√©tection de SSRF (Server-Side Request Forgery)
- D√©tection d'injections XXE (XML External Entity)
- D√©tection de vuln√©rabilit√©s IDOR (Insecure Direct Object References)
- D√©tection d'injections de template (SSTI)
- Et bien d'autres vuln√©rabilit√©s avanc√©es

### üìÑ G√©n√©rateur de rapports

Le module `report_generator.py` cr√©e des rapports d√©taill√©s et hautement lisibles :

- Formats HTML et PDF
- R√©sum√© ex√©cutif pour les d√©cideurs
- D√©tails techniques pour les √©quipes de d√©veloppement
- Captures d'√©cran et preuves de concept
- Recommandations de correction prioris√©es
- M√©triques de s√©v√©rit√© (CVSS)

### üîê Gestion des utilisateurs et authentification

Le module `auth.py` fournit une gestion compl√®te des utilisateurs :

- Cr√©ation et gestion de comptes utilisateurs
- Hachage s√©curis√© des mots de passe avec bcrypt
- Authentification via Basic Auth, formulaires et JWT
- Gestion des r√¥les et permissions
- Protection contre les attaques par force brute

### üí£ G√©n√©rateur de charges utiles

Le module `payload_generator.py` permet de cr√©er et g√©rer des charges utiles personnalis√©es :

- Biblioth√®que de charges utiles pr√©d√©finies pour diff√©rents types d'attaques
- Cr√©ation de charges utiles personnalis√©es
- Transformation des charges utiles (encodage URL, HTML, Base64, etc.)
- Obfuscation pour contourner les protections
- Organisation par cat√©gories et ensembles

### üîç Moteur de sc√©nario YAML

Le module `utils.py` contient un moteur de sc√©nario avanc√© qui :

- Ex√©cute des sc√©narios de test complets √† partir de fichiers YAML
- Prend en charge de nombreux types d'√©tapes (recon, scan, ai, auth, etc.)
- Permet de sp√©cifier des options pour chaque √©tape
- Sauvegarde automatiquement les r√©sultats dans un dossier horodat√©
- G√©n√®re un fichier JSON avec tous les r√©sultats

## üîí S√©curit√© et √âthique

Ce projet est con√ßu pour des **tests de s√©curit√© l√©gitimes**. Utilisez-le uniquement avec une autorisation explicite dans le cadre de :

- ‚úÖ Tests de p√©n√©tration autoris√©s
- ‚úÖ Formations de sensibilisation
- ‚úÖ √âvaluations de s√©curit√© internes
- ‚úÖ Environnements de test et d√©veloppement

## ü§ù Contribuer

Les contributions sont les bienvenues ! N'h√©sitez pas √† ouvrir une issue ou √† soumettre une pull request pour am√©liorer l'outil.

1. Forkez le projet
2. Cr√©ez votre branche de fonctionnalit√© (`git checkout -b feature/amazing-feature`)
3. Committez vos changements (`git commit -m 'Add some amazing feature'`)
4. Poussez vers la branche (`git push origin feature/amazing-feature`)
5. Ouvrez une Pull Request

## üìÑ Licence

Ce projet est sous licence MIT. Voir le fichier LICENSE pour plus de d√©tails.

---

<p align="center">
  <sub>üîê D√©velopp√© pour promouvoir la s√©curit√© web et les tests d'intrusion √©thiques üõ°Ô∏è</sub>
</p>
